<!DOCTYPE html>
<html>
<head>
    <title>Partiu It√°lia</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            touch-action: none;
            background-color: #000;
        }
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            position: fixed;
        }
        #gameContainer {
            position: relative;
            width: 100%;
            height: 100%;
            max-width: 400px;
            max-height: 600px;
            margin: auto;
        }
        #gameCanvas {
            width: 100%;
            height: 100%;
            display: block;
            border: 2px solid white;
        }
        @media screen and (orientation: landscape) {
            #gameContainer::before {
                content: "Please rotate your device to portrait mode";
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: black;
                color: white;
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 100;
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
    </div>
    <script>
        // Game constants
        const GAME_WIDTH = 400;
        const GAME_HEIGHT = 600;
        const WINNING_SCORE = 10;
        const PIPE_GAP = 150;
        const PIPE_WIDTH = 80;
        const PIPE_HEIGHT = 400;
        const PIPE_DISTANCE = 200;
        
        // Game state
        let canvas, ctx;
        let gameWidth, gameHeight;
        let scaleFactor = 1;
        let birdX = 50, birdY = GAME_HEIGHT / 2;
        let birdRect = { x: birdX, y: birdY, width: 40, height: 30 };
        let gravity = 0.3;
        let velocity = 0;
        let pipes = [];
        let score = 0;
        let pipeSpeed = 2;
        let gameOver = false;
        let gameWon = false;
        
        // Assets
        let backgroundImg, birdImg, pipeImgs = [], winScreenImg;
        let flapSound = null, backgroundMusic = null;
        let assetsLoaded = 0;
        const totalAssets = 7;

        // Initialize game with proper mobile scaling
        function initGame() {
            const container = document.getElementById('gameContainer');
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            
            // Set canvas size to match game dimensions
            canvas.width = GAME_WIDTH;
            canvas.height = GAME_HEIGHT;
            
            // Calculate scaling for mobile devices
            function resizeCanvas() {
                const containerWidth = container.clientWidth;
                const containerHeight = container.clientHeight;
                
                // Calculate scale to fit container
                const scaleX = containerWidth / GAME_WIDTH;
                const scaleY = containerHeight / GAME_HEIGHT;
                scaleFactor = Math.min(scaleX, scaleY);
                
                // Apply scaling
                canvas.style.width = (GAME_WIDTH * scaleFactor) + 'px';
                canvas.style.height = (GAME_HEIGHT * scaleFactor) + 'px';
            }
            
            // Initial resize
            resizeCanvas();
            
            // Handle window resizing
            window.addEventListener('resize', resizeCanvas);
            
            // Start music muted first to satisfy autoplay policies
            if (backgroundMusic) {
                backgroundMusic.muted = true;
                backgroundMusic.play()
                    .then(() => {
                        backgroundMusic.muted = false;
                    })
                    .catch(e => {
                        console.log("Autoplay prevented, will start after user interaction");
                    });
            }
            
            showStartScreen();
        }

        // [Rest of your game functions remain the same, but use GAME_WIDTH/GAME_HEIGHT instead of WIDTH/HEIGHT]
        // Pipe creation, drawing functions, screens, game logic etc.
        // ...

        // Prevent default touch behaviors
        document.addEventListener('touchstart', function(e) {
            if (e.target === canvas) {
                e.preventDefault();
            }
        }, { passive: false });

        document.addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, { passive: false });

        document.addEventListener('touchend', function(e) {
            if (e.target === canvas) {
                e.preventDefault();
            }
        }, { passive: false });

        // Load assets and start game when ready
        window.addEventListener('load', function() {
            loadAssets();
        });
    </script>
</body>
</html>
